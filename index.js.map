{"version":3,"file":"index.js","sources":["../src/js/pixabay-api.js","../src/js/getImage-api.js","../src/main.js"],"sourcesContent":["import axios from 'axios';\n\nconst API_KEY = '29490885-39aa37afc891f3eb40eae4912';\nconst BASE_URL = 'https://pixabay.com/api/';\n\nexport async function searchImages(query, page = 1, per_page = 40) {\n  const params = {\n    key: API_KEY,\n    q: query,\n    image_type: 'photo',\n    orientation: 'horizontal',\n    safesearch: true,\n    page,\n    per_page\n  };\n\n  try {\n    const response = await axios.get(BASE_URL, { params });\n    return response.data;\n  } catch (error) {\n    throw new Error(error.response.statusText || error.message);\n  }\n}\n","export function addImage(image) {\n  const neccesaryArray = image.hits;\n  return neccesaryArray.map(\n    ({\n      webformatURL,\n      largeImageURL,\n      tags,\n      likes,\n      views,\n      comments,\n      downloads,\n    }) => `\n        <li class=\"card\">\n            <div class=\"place-for-image\">\n                <a href=\"${largeImageURL}\">\n                    <img src=\"${webformatURL}\" alt=\"${tags}\" class=\"picture\"/>\n                </a>\n            </div>\n            <div class=\"info-text\">\n                <div class=\"description\">\n                    <span class=\"bold-text\">Likes</span>\n                    <span class=\"info-value\">${likes}</span>\n                </div>\n                <div class=\"description\">\n                    <span class=\"bold-text\">Views</span>\n                    <span class=\"info-value\">${views}</span>\n                </div>\n                <div class=\"description\">\n                    <span class=\"bold-text\">Comments</span>\n                    <span class=\"info-value\">${comments}</span>\n                </div>\n                <div class=\"description\">\n                    <span class=\"bold-text\">Downloads</span>\n                    <span class=\"info-value\">${downloads}</span>\n                </div>\n            </div>\n        </li>`,\n  ).join('');\n}","import iziToast from 'izitoast';\nimport 'izitoast/dist/css/iziToast.min.css';\n\nimport SimpleLightbox from 'simplelightbox';\nimport 'simplelightbox/dist/simple-lightbox.min.css';\n\nimport { searchImages } from './js/pixabay-api.js';\nimport { addImage } from './js/getImage-api.js';\n\nlet currentPage = 1;\nlet currentQuery = '';\nlet totalHits = 0;\nlet imagesShown = 0;\n\nconst loader = document.querySelector('.loader');\nconst form = document.getElementById('searchForm');\nconst galleryElement = document.querySelector('.gallery');\n\nconst loadMoreBtn = document.getElementById('loadMoreBtn');\n\nform.addEventListener('submit', onSearch);\nloadMoreBtn.addEventListener('click', onLoadMore);\n\nasync function onSearch(e) {\n  e.preventDefault();\n  galleryElement.innerHTML = '';\n  toogleLoader('block');\n\n  currentQuery = e.currentTarget.elements.searchInput.value.trim();\n  currentPage = 1;\n  imagesShown = 0;\n\n  try {\n    const data = await searchImages(currentQuery, currentPage);\n    totalHits = data.totalHits;\n\n    if (data.hits.length === 0) {\n      iziToast.warning({ title: 'Caution', message: 'No images found!' });\n      loadMoreBtn.style.display = 'none';\n      return;\n    }\n\n    renderGallery(data);\n    showLoadMore(data);\n    e.target.reset();\n  } catch (error) {\n    iziToast.error({ title: 'Error', message: error.message });\n  } finally {\n    toogleLoader('none');\n  }\n}\n\nasync function onLoadMore() {\n  currentPage++;\n  toogleLoader('block');\n\n  try {\n    const data = await searchImages(currentQuery, currentPage);\n    renderGallery(data);\n    showLoadMore(data);\n    scrollGallery();\n  } catch (error) {\n    iziToast.error({ title: 'Error', message: error.message });\n  } finally {\n    toogleLoader('none');\n  }\n}\n\nfunction renderGallery(data) {\n  imagesShown += data.hits.length;\n  galleryElement.insertAdjacentHTML('beforeend', addImage(data));\n  lightbox.refresh();\n}\n\nfunction showLoadMore(data) {\n  if (imagesShown >= totalHits) {\n    loadMoreBtn.style.display = 'none';\n    iziToast.info({ title: 'Info', message: \"We're sorry, but you've reached the end of search results.\" });\n  } else {\n    loadMoreBtn.style.display = 'block';\n  }\n}\n\nfunction scrollGallery() {\n  const card = document.querySelector('.gallery .card');\n  const cardHeight = card?.getBoundingClientRect().height || 0;\n  window.scrollBy({ top: cardHeight * 2, behavior: 'smooth' });\n}\n\n\nconst lightbox = new SimpleLightbox('.card .place-for-image a', {\n  captions: true,\n  captionsData: 'alt',\n  captionDelay: 250,\n});\n\nfunction toogleLoader(display) {\n  loader.style.display = display;\n}\n\nloader.style.display = 'none';\n\nform.addEventListener('submit', search);\n\nasync function search(e) {\n  e.preventDefault();\n\n  galleryElement.innerHTML = '';\n\n  const input = e.currentTarget.elements.searchInput.value;\n\n  toogleLoader('block');\n\n  searchImages(input).then(data => {\n    if (data.total === 0) {\n      iziToast.warning({\n        title: 'Caution',\n        message: 'Sorry, there are no images matching your search query. Please try again!',\n      });\n\n      return 0;\n    } else {\n      galleryElement.insertAdjacentHTML('beforeend', addImage(data));\n      lightbox.refresh();\n      e.target.reset();\n    }\n  }).catch(error => {\n    iziToast.error({\n      title: 'Error',\n      message: error.message,\n    });\n  }).finally(() => {\n    toogleLoader('none');\n  });\n}"],"names":["API_KEY","BASE_URL","searchImages","query","page","per_page","params","axios","error","addImage","image","webformatURL","largeImageURL","tags","likes","views","comments","downloads","currentPage","currentQuery","totalHits","imagesShown","loader","form","galleryElement","loadMoreBtn","onSearch","onLoadMore","toogleLoader","data","iziToast","renderGallery","showLoadMore","scrollGallery","lightbox","card","cardHeight","SimpleLightbox","display","search","input"],"mappings":"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"}